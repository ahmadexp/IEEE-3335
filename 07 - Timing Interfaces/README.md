# Timing Interfaces (Normative)

This chapter defines the interfaces through which a TimeCard exchanges timing and frequency information with external systems. These interfaces form the core of interoperability between TimeCards, host platforms, and external timing networks. All implementations **SHALL** adhere to standardized electrical, protocol, and logical interface behaviors to ensure cross-vendor compatibility and predictable operation.

---

## 1 - Overview

A TimeCard typically incorporates two fundamental classes of timing interfaces:

1. **Receive Interfaces** — used to acquire timing from external sources.  
2. **Providing Interfaces** — used to distribute disciplined time and frequency to the host and other consumers.

Additionally, **management and control interfaces** facilitate configuration, monitoring, and diagnostics. Each class of interface has distinct performance, signaling, and protocol requirements, defined in the following sections.

---

## 2 - Receive Interfaces

The **receive interface** enables the TimeCard to lock its internal oscillator to one or more external references, establishing synchronization to a higher-order time source.

### 2.1 - Supported Reference Types
The following external references are recognized for TimeCard synchronization:
- **GNSS Receivers** (e.g., GPS, Galileo, GLONASS, BeiDou) providing 1PPS and NMEA/ToD signals.  
- **PTP (IEEE 1588)** via Ethernet or PCIe networks.  
- **NTP (RFC 5905)** for lower-accuracy time distribution.  
- **White Rabbit (WR)** for sub-nanosecond synchronization via deterministic Ethernet.  
- **WWVB / DCF77 / MSF** radio standards for low-cost regional timing.  
- **WiWi** (IEEE 802.1AS extensions) for wireless precision timing.  
- **1PPS / 10 MHz** electrical references for local or chained synchronization.

### 2.2 - Interface Characteristics
Each receive interface **SHALL** specify:
- **Electrical level** (e.g., CMOS, LVTTL, RS-422)  
- **Input impedance and termination**  
- **Signal polarity and edge definition**  
- **Lock acquisition time**  
- **Holdover behavior upon loss**  

### 2.3 - Input Redundancy and Selection
TimeCards supporting multiple references **SHALL** implement deterministic source selection logic.  
Source priority and failover policy **MUST** be configurable via management interface.  
Failover **SHOULD** occur seamlessly with phase continuity (hitless switching).

### 2.4 - Sensitivity and Thresholds
The receive path **SHALL** tolerate nominal input amplitude variations of ±20% and reject noise consistent with ITU-T G.8260 sensitivity definitions.  
Loss-of-signal and reacquisition thresholds **MUST** be documented in vendor datasheets.

---

## 3 - Providing Interfaces

The **providing interface** delivers synchronized time and frequency from the TimeCard to the host platform or external devices.

### 3.1 - Output Signal Classes
Typical providing interfaces include:
- **Pulse-Per-Second (PPS)** — primary second-aligned reference pulse.  
- **Frequency Outputs (10 MHz / 5 MHz)** — for frequency synchronization.  
- **Time of Day (ToD)** — serial-formatted absolute time delivery (NMEA, IRIG, or binary).  
- **Packetized Time (PTP)** — via Ethernet or PCIe.  
- **In-Bus Timing (PTM)** — PCIe Precision Time Measurement transactions.  
- **Synchronous Clocks** — for FPGA or SoC logic domains.

### 3.2 - Electrical and Protocol Standards
All physical outputs **SHALL** comply with standard signaling levels:
- PPS and frequency outputs: 3.3 V CMOS or LVTTL at 50 Ω termination.  
- ToD/Serial outputs: RS-232 or RS-422 compliant.  
- PCIe/PTM: per PCI-SIG 5.0+ specification.  
- Ethernet/PTP: IEEE 1588-2019 and IEEE 802.1AS-2020 compliant.

Each interface **MUST** specify rise/fall times, jitter limits, impedance, and drive capability.

### 3.3 - Synchronization Accuracy
Output signals **SHALL** align to the unified timescale generated by the TimeCard (§7.1).  
For compliant designs, PPS alignment error **MUST NOT** exceed 1 ns RMS relative to the master reference.  
Output clocks **SHOULD** exhibit deterministic phase and frequency continuity during source transitions.

### 3.4 - Hardware Timestamping
Providing interfaces **SHALL** support hardware timestamping where applicable, including:
- PPS edge capture  
- PCIe PTM transactions  
- PTP transmit and receive timestamps  

Timestamping accuracy **MUST** be traceable to the internal oscillator and calibrated against reference latency paths.

---

## 4 - Management and Control Interfaces

Management interfaces define the logical communication path for configuration, telemetry, and firmware control. These are **non-timing-critical** but essential for operational management.

### 4.1 - Common Management Interfaces
| Interface | Typical Use | Bandwidth | Example Use Case |
|------------|--------------|------------|------------------|
| **SMBus / I²C** | Low-level configuration | Low | Telemetry, clock control |
| **IPMI** | Out-of-band server management | Medium | Platform health monitoring |
| **PCIe Config Space** | In-band control | High | Status registers, PTM control |
| **Serial / USB** | Maintenance and updates | Medium | Firmware flashing, diagnostics |
| **REST / gRPC / SNMP** | Remote network control | Variable | Distributed management systems |

### 4.2 - Management Capabilities
Management interfaces **SHALL** allow read/write access to:  
- Active synchronization source and state  
- Oscillator mode (locked, holdover, free-run)  
- Phase/frequency offset statistics  
- Alarm and event logs  
- Firmware version and security status  

### 4.3 - Security Requirements
- All management channels **MUST** support authentication (username, token, or certificate).  
- Firmware updates **MUST** use cryptographic signing and integrity verification.  
- Telemetry data **SHOULD** be encrypted when transmitted across shared or external networks.

---

## 5 - Physical and Logical Integration

### 5.1 - Connectors and Labeling
TimeCard front panels **SHALL** label all timing and management ports clearly.  
Example:
```
[GNSS] [PPS OUT] [10MHz] [ToD] [MGMT] [USB]
```

Color coding and standardized iconography **SHOULD** be adopted per OCP-TAP recommendations.

### 5.2 - Interoperability Requirements
- All outputs **MUST** publish the same unified timescale.  
- Interfaces **SHOULD** support cross-vendor interoperability using common electrical and logical formats.  
- Optional extensions **MUST NOT** disrupt baseline compatibility.

---

## 6 - Summary

Timing interfaces define the foundation of the TimeCard’s interoperability, enabling precise, deterministic, and cross-vendor synchronization.  
Compliance with these interface definitions ensures that all TimeCards—regardless of vendor or design—can seamlessly integrate into diverse host environments, maintain traceable time accuracy, and deliver stable frequency and phase alignment.
